@startuml Prospect Enrichment Flow

title Prospect Enrichment - API Flow

actor Usuario as U
participant "ProspectController" as PC
participant "ProspectEnrichmentFacade" as PEF
participant "ScraperClientInterface" as SCI
participant "AIWebSearchScraperClient" as AISC
participant "ScraperDataMapper" as SDM
participant "CompanyEnrichmentService" as CES
participant "ContactProcessor" as CP
participant "ProspectEnrichService" as PES
participant "ProspectorAIService" as PAS

U -> PC: POST /api/prospect/enrich
PC -> PEF: enrich(request)
PEF -> SCI: scrapeWebsiteSync(website, false)
SCI -> AISC: scrapeWebsiteSync()
AISC --> SCI: ScrapingResponse(data)
SCI --> PEF: ScrapingResponse(data)
PEF -> SDM: fromScraperData(data, website)
SDM --> PEF: EnrichmentRequest
PEF -> CES: enrichCompanyData(request)
CES --> PEF: EnrichmentResult
PEF -> CP: processContacts(validatedContacts)
PEF -> PES: enrichCompany(company)
PES -> PAS: enrichCompany(company)
PAS --> PES: analysis text
PES --> PEF: analysis text
PEF --> PC: ProspectEnrichResponse
PC --> U: JSON response

@enduml
